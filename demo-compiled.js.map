{"version":3,"sources":["demo.js"],"names":[],"mappings":"AAAA,IAAI,SAAS,CAAC,GAAG,SAAS,gBAAT,CAA0B,QAA1B,CAAJ,CAAb;AACA,IAAI,YAAY,SAAS,aAAT,CAAuB,YAAvB,CAAhB;AACA,IAAI,gBAAgB,KAApB,C,CAA0B;AAC1B,IAAI,WAAW,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,GAAG,MAAM,CAAN,EAAS,IAAT,CAAc,CAAd,EAAiB,GAAjB,CAAqB,MAAI,MAAK,cAAc,IAAd,EAAmB,IAAnB,CAA9B,EAAyD,IAAzD,EAAtB,CAAf,C,CAAsG;AACtG,IAAI,WAAW,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,CAAf,C,CAAiC;AACjC,IAAI,aAAa,IAAI,MAAJ,EAAjB,C,CAA8B;AAC9B,SAAS,OAAT,CAAiB,CAAC,IAAD,EAAM,KAAN,KAAc;AAAC;AAC5B,eAAY,SAAQ,IAAK,EAAzB,IAA8B,SAAS,KAAT,CAA9B;AACH,CAFD;AAGA,SAAS,QAAT,CAAkB,MAAlB,EAAyB;AAAC;AACtB,WAAO,OAAP,CAAe,CAAC,KAAD,EAAO,KAAP,KAAe;AAC1B,cAAM,KAAN,CAAY,eAAZ,GAA+B,eAAc,QAAM,CAAE,SAArD;AACA,cAAM,KAAN,CAAY,GAAZ,GAAmB,GAAE,MAAI,QAAM,EAAG,IAAlC;AACA,cAAM,KAAN,CAAY,SAAZ,GAAyB,8CAAzB;AACH,KAJD;AAKH;;AAED,IAAI,WAAU,CAAC,CAAC,IAAD,EAAM,IAAN,EAAW,GAAX,CAAD,EAAiB,CAAC,IAAD,EAAM,GAAN,EAAU,IAAV,CAAjB,EAAiC,CAAC,IAAD,EAAM,GAAN,EAAU,IAAV,CAAjC,EAAiD,CAAC,IAAD,EAAM,IAAN,EAAW,GAAX,CAAjD,EAAiE,CAAC,GAAD,EAAK,IAAL,EAAU,IAAV,CAAjE,EAAiF,CAAC,GAAD,EAAK,IAAL,EAAU,IAAV,CAAjF,CAAd;AACA,SAAS,aAAT,CAAuB,MAAvB,EAA8B,QAA9B,EAAuC;AAAC;AACpC,QAAI,UAAU,IAAI,MAAJ,EAAd;AACA,WAAO,OAAP,CAAe,CAAC,KAAD,EAAO,KAAP,KAAe;AAC1B,gBAAQ,MAAM,EAAd,IAAoB,SAAS,KAAK,KAAL,CAAW,cAAc,CAAd,EAAgB,CAAhB,CAAX,CAAT,CAApB;AACH,KAFD;AAGA,WAAO,OAAP;AACH;AACD,SAAS,SAAT,CAAmB,MAAnB,EAA0B,SAAS,EAAnC,EAAsC,YAAY,EAAlD,EAAqD,QAAQ,aAA7D,EAA2E;AAAC;AACxE,aAAS,MAAT;AACA,QAAI,UAAU,cAAc,MAAd,EAAqB,QAArB,CAAd;AACA,QAAI,UAAU,IAAd;AACA,QAAI,qBAAqB,CAAzB;AACA,QAAI,UAAU,CAAd;AACA,aAAS,IAAT,GAAe;AACX,YAAI,cAAc,cAAc,MAAd,CAAlB;AACA,eAAO,OAAP,CAAe,CAAC,KAAD,EAAO,KAAP,KAAe;AAC1B,gBAAG,SAAS,YAAY,MAAM,EAAlB,CAAT,IAAgC,QAAM,CAAzC,EAA2C;AAAC;AACxC,uBAAO,MAAM,EAAb,IAAoB,QAAM,CAAP,IAAW,WAAW,MAAM,EAAjB,IAAsB,QAAQ,MAAM,EAAd,EAAkB,CAAlB,CAAtB,GAA4C,EAAvD,CAAnB,CADuC,CACuC;AACjF,aAFD,MAEM,IAAG,SAAS,YAAY,MAAM,EAAlB,CAAT,KAAiC,QAAM,CAAvC,IAA0C,SAAS,YAAY,MAAM,EAAlB,CAAT,IAAgC,QAAM,CAAN,GAAQ,CAArF,EAAuF;AAAC;AAC1F,uBAAO,MAAM,EAAb,IAAoB,QAAM,CAAP,IAAW,WAAW,MAAM,EAAjB,IAAsB,QAAQ,MAAM,EAAd,EAAkB,CAAlB,CAAtB,GAA4C,EAAvD,CAAnB,CADyF,CACX;AACjF,aAFK,MAEA,IAAG,SAAS,YAAY,MAAM,EAAlB,CAAT,KAAiC,QAAM,CAAN,GAAQ,CAA5C,EAA8C;AAAC;AACjD,uBAAO,MAAM,EAAb,IAAoB,QAAM,CAAP,IAAW,WAAW,MAAM,EAAjB,IAAsB,QAAQ,MAAM,EAAd,EAAkB,CAAlB,CAAtB,GAA4C,EAAvD,CAAnB,CADgD,CAC8B;AACjF;AACD,sBAAU,MAAM,EAAhB,IAAsB,UAAU,MAAM,EAAhB,KAAuB,CAA7C;AACA,sBAAU,MAAM,EAAhB,KAAuB,OAAO,MAAM,EAAb,CAAvB;AACA,kBAAM,KAAN,CAAY,IAAZ,GAAoB,GAAE,UAAU,MAAM,EAAhB,CAAoB,IAA1C;AACH,SAXD;AAYA,YAAI,WAAW,KAAK,GAAL,CAAS,GAAG,OAAO,MAAP,CAAc,MAAd,CAAZ,CAAf;AACA,YAAI,WAAW,KAAK,GAAL,CAAS,GAAG,OAAO,MAAP,CAAc,MAAd,CAAZ,CAAf;AACA,YAAI,UAAU,KAAK,GAAL,CAAS,GAAG,OAAO,MAAP,CAAc,WAAd,EAA2B,GAA3B,CAAgC,KAAD,IAAS,SAAS,KAAT,CAAxC,CAAZ,CAAd;AACA,8BAAsB,EAAtB,CAjBW,CAiBc;AACzB,kBAAU,UAAQ,GAAR,GAAY,CAAZ,GAAc,UAAQ,GAAhC,CAlBW,CAkByB;;AAEpC,eAAO,QAAP,CAAgB,OAAhB,EAAwB,CAAxB,EApBW,CAoBgB;AAC3B,kBAAU,KAAV,CAAgB,kBAAhB,GAAsC,GAAE,kBAAmB,MAA3D,CArBW,CAqBsD;AACjE,kBAAU,WAAW,IAAX,EAAgB,OAAK,EAArB,CAAV;AACH;AACD;AACH;AACD,UAAU,MAAV;AACA,SAAS,aAAT,CAAuB,CAAvB,EAAyB,CAAzB,EAA2B;AAAC;AACxB,WAAO,KAAK,MAAL,MAAe,IAAE,CAAjB,IAAoB,CAA3B;AACH;AACD,SAAS,aAAT,CAAuB,MAAvB,EAA8B;AAAC;AAC3B,QAAI,cAAc,IAAI,MAAJ,EAAlB;AACA,WAAO,OAAP,CAAgB,KAAD,IAAS,YAAY,MAAM,EAAlB,IAAuB,OAAO,gBAAP,CAAwB,KAAxB,EAA+B,IAA9E;AACA,WAAO,WAAP;AACH;AACD;;;AAGA","file":"demo-compiled.js","sourcesContent":["let horses = [...document.querySelectorAll('.horse')];\r\nlet horseWrap = document.querySelector('.horseWrap');\r\nlet totalDistance = 10000;//总共要跑的距离\r\nlet duration = [220.0,230.3,230.6,...Array(5).fill(1).map(()=>300*(randomBetween(0.77,0.78))).sort()];//预先设定每匹马要跑的时间\r\nlet openData = [8,4,5,6,1,3,2,7];//从后台传回的开奖结果\r\nlet openResult = new Object();//声明一个对象来存储openData和duration的对应关系\r\nopenData.forEach((item,index)=>{//openData和duration对应\r\n    openResult[`horse_${item}`] = duration[index];\r\n});\r\nfunction horseRun(horses){//马跑的动作函数\r\n    horses.forEach((horse,index)=>{\r\n        horse.style.backgroundImage = `url(./horse_${index+1}_a.png)`;\r\n        horse.style.top = `${100+index*20}px`;\r\n        horse.style.animation = `horse_run infinite 450ms forwards step-start`;\r\n    });\r\n}\r\n\r\nlet timeMaps= [[0.35,0.45,0.2],[0.35,0.2,0.45],[0.45,0.2,0.35],[0.45,0.35,0.2],[0.2,0.45,0.35],[0.2,0.35,0.45]];\r\nfunction createTimeMap(horses,timeMaps){//随机每匹马的时间分配\r\n    let timeObj = new Object();\r\n    horses.forEach((horse,index)=>{\r\n        timeObj[horse.id] = timeMaps[Math.floor(randomBetween(0,6))];\r\n    });\r\n    return timeObj;\r\n}\r\nfunction horseMove(horses,speeds = {},leftValue = {},total = totalDistance){//赛马\r\n    horseRun(horses);\r\n    let timeMap = createTimeMap(horses,timeMaps);\r\n    let timeout = null;\r\n    let horseWrapLeftValue = 0;\r\n    let scrollX = 0;\r\n    function move(){\r\n        let horsesLefts = getHorsesLeft(horses);\r\n        horses.forEach((horse,index)=>{\r\n            if(parseInt(horsesLefts[horse.id])<total/3){//分三段，第一段的速度\r\n                speeds[horse.id] = (total/3)/(openResult[horse.id]*(timeMap[horse.id][0])*16);//第一段占总时间35%，写死\r\n            }else if(parseInt(horsesLefts[horse.id])>=total/3&&parseInt(horsesLefts[horse.id])<total*2/3){//第二段的速度\r\n                speeds[horse.id] = (total/3)/(openResult[horse.id]*(timeMap[horse.id][1])*16);//第二段占总时间50%，写死\r\n            }else if(parseInt(horsesLefts[horse.id])>=total*2/3){//第三段的速度\r\n                speeds[horse.id] = (total/3)/(openResult[horse.id]*(timeMap[horse.id][2])*16);//第三段占总时间15%，写死\r\n            }\r\n            leftValue[horse.id] = leftValue[horse.id] || 0;\r\n            leftValue[horse.id] += speeds[horse.id];\r\n            horse.style.left = `${leftValue[horse.id]}px`;\r\n        });\r\n        let speedMin = Math.min(...Object.values(speeds));\r\n        let speedMax = Math.max(...Object.values(speeds));\r\n        let leftMax = Math.max(...Object.values(horsesLefts).map((value)=>parseInt(value)));\r\n        horseWrapLeftValue -= 30;//背景切换速度\r\n        scrollX = leftMax<960?0:leftMax-960;//防止马跑出屏幕外看不到\r\n\r\n        window.scrollTo(scrollX,0);//摄像机移动\r\n        horseWrap.style.backgroundPosition = `${horseWrapLeftValue}px 0`;//背景跟着动\r\n        timeout = setTimeout(move,1000/16);\r\n    }\r\n    move();\r\n}\r\nhorseMove(horses);\r\nfunction randomBetween(a,b){//获取两个数之间的随机数\r\n    return Math.random()*(b-a)+a;\r\n}\r\nfunction getHorsesLeft(horses){//获取每匹马的left值,即跑的距离\r\n    let horsesLefts = new Object();\r\n    horses.forEach((horse)=>horsesLefts[horse.id]= window.getComputedStyle(horse).left);\r\n    return horsesLefts;\r\n}\r\n/*把路程分成3段，每段的速度不一样，可中慢快，中快慢，慢快中，慢中快，快慢中，快中慢六种;\r\n * 把时间分成三段，[[0.35,0.5,0.15],[0.35,0.15,0.5],[0.5,0.35,0.15],[0.5,0.15,0.35],[0.15,0.5,0.35],[0.15,0.35,0.5]]六种;\r\n * */\r\n/*function createSpeed(){//随机生成跑步速度\r\n return Array(8).fill(1).map(()=>(randomBetween(0.7,1)*5));\r\n }*/\r\n\r\n"]}